<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OBEARCO ‚Ä¢ RPG Hub</title>
  <meta name="color-scheme" content="dark light" />
  <style>
    :root{
      --bg:#07090c;
      --panel: rgba(16,20,26,.72);
      --glass: rgba(255,255,255,.06);
      --text:#eaf2ff;
      --muted:#a7b4c7;
      --border: rgba(180,210,255,.12);
      --accent:#5aa6ff;
      --ok:#22c55e;
      --bad:#ef4444;
      --warn:#f59e0b;
      --shadow: 0 18px 65px rgba(0,0,0,.45);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1100px 650px at 15% -10%, rgba(90,166,255,.14), transparent 55%),
        radial-gradient(900px 650px at 95% 5%, rgba(139,92,246,.14), transparent 55%),
        var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }
    .app{min-height:100vh; display:flex; flex-direction:column}
    .topbar{
      position:sticky; top:0; z-index:50;
      background: rgba(7,9,12,.65);
      backdrop-filter: blur(12px);
      border-bottom:1px solid var(--border);
    }
    .topbar-inner{
      max-width:1100px;
      margin:0 auto;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{display:flex; align-items:center; gap:12px; font-weight:900; letter-spacing:.5px;}
    .brand .title{display:flex; flex-direction:column; line-height:1.1}
    .brand .title .sub{font-size:12px; color:var(--muted); font-weight:700}
    .dot{
      width:11px;height:11px;border-radius:999px;
      background:var(--warn);
      box-shadow:0 0 0 6px rgba(245,158,11,.10);
      transition:.25s ease;
    }
    .nav{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
    .btn{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      transition: transform .15s ease, filter .15s ease, border-color .15s ease;
      display:inline-flex; align-items:center; gap:8px;
      font-weight:800;
      letter-spacing:.2px;
      user-select:none;
    }
    .btn:hover{transform:translateY(-1px); filter:brightness(1.06); border-color: rgba(180,210,255,.22)}
    .btn:active{transform:translateY(0px); filter:brightness(1.02)}
    .btn.primary{
      border-color: rgba(90,166,255,.32);
      background: linear-gradient(180deg, rgba(90,166,255,.22), rgba(90,166,255,.10));
    }
    .btn.ghost{background:transparent}
    .btn.danger{
      border-color: rgba(239,68,68,.30);
      background: linear-gradient(180deg, rgba(239,68,68,.18), rgba(239,68,68,.08));
    }
    .container{
      max-width:1100px; width:100%;
      margin:0 auto; padding:18px 16px 34px;
      display:grid; gap:16px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      animation: fadeUp .35s ease both;
    }
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      position:relative;
      overflow:hidden;
    }
    .card:before{
      content:"";
      position:absolute;
      inset:-1px;
      background:
        radial-gradient(800px 220px at 20% 0%, rgba(90,166,255,.14), transparent 55%),
        radial-gradient(800px 220px at 80% 0%, rgba(139,92,246,.12), transparent 55%);
      opacity:.65;
      pointer-events:none;
      mix-blend-mode: screen;
    }
    .card > *{position:relative}
    .card h2{margin:0 0 8px; font-size:18px}
    .muted{color:var(--muted)}
    .mini{font-size:12px}
    .tag{font-family:var(--mono); font-size:12px; opacity:.92; word-break:break-all}
    .hr{height:1px; background:var(--border); margin:12px 0}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .field{display:flex; flex-direction:column; gap:7px}
    .field label{font-size:12px; color:var(--muted); font-weight:800; letter-spacing:.2px}
    input, textarea{
      width:100%;
      padding:11px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.22);
      color:var(--text);
      outline:none;
    }
    textarea{min-height:120px; resize:vertical; font-family:var(--mono); font-size:12.5px}
    input:focus, textarea:focus{border-color: rgba(90,166,255,.32); box-shadow: 0 0 0 4px rgba(90,166,255,.10)}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px; border-radius:999px; font-size:12px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.18);
      color:var(--muted);
      font-weight:800;
    }
    .pill.ok{border-color: rgba(34,197,94,.32); color:#b7f7cb; background:rgba(34,197,94,.08)}
    .pill.bad{border-color: rgba(239,68,68,.32); color:#ffd0d0; background:rgba(239,68,68,.08)}
    .pill.warn{border-color: rgba(245,158,11,.32); color:#ffe2b3; background:rgba(245,158,11,.08)}
    .toast-wrap{
      position:fixed; right:16px; bottom:16px; z-index:9999;
      display:flex; flex-direction:column; gap:10px;
      max-width:min(520px, calc(100vw - 32px));
    }
    .toast{
      border:1px solid var(--border);
      background: rgba(7,9,12,.75);
      backdrop-filter: blur(10px);
      border-radius:16px;
      padding:10px 12px;
      box-shadow:var(--shadow);
      display:flex; gap:10px; align-items:flex-start;
      animation: toastIn .22s ease both;
    }
    .toast b{display:block; margin-bottom:2px}
    @keyframes toastIn{from{opacity:0; transform: translateY(8px)} to{opacity:1; transform: translateY(0)}}
    @keyframes fadeUp{from{opacity:0; transform: translateY(6px)} to{opacity:1; transform: translateY(0)}}
    .footer{
      max-width:1100px; margin:0 auto 24px; padding:0 16px;
      color:var(--muted); font-size:12px; display:flex; justify-content:space-between;
      gap:12px; flex-wrap:wrap; opacity:.9;
    }
    .two{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width: 760px){ .two{grid-template-columns:1fr} }
  </style>
</head>
<body>
<div class="app">
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <span class="dot" id="srvDot"></span>
        <div class="title">
          <div>OBEARCO <span class="muted">RPG Hub</span></div>
          <div class="sub" id="srvLine">Carregando status‚Ä¶</div>
        </div>
      </div>
      <div class="nav" id="nav"></div>
    </div>
  </div>

  <main class="container" id="app"></main>

  <div class="footer">
    <div>‚öîÔ∏è OBEARCO ‚Ä¢ UI p√∫blico (GitHub Pages)</div>
    <div class="muted">Sempre manda JSON e usa /api/v1/cmd.</div>
  </div>
</div>

<div class="toast-wrap" id="toasts"></div>

<script>
/* ============================================================
   CONFIG
   ============================================================ */
const STATUS_GITHUB_URL = "https://github.com/NoSense-Bot/Servidor/blob/main/server_status.json";

const LS = {
  token: "obearco_session_token",
  apiBase: "obearco_api_base_cache",
};

const state = {
  status: null,
  apiBase: "",
  token: localStorage.getItem(LS.token) || "",
  route: location.hash || "#/login",
};

/* ============================================================
   Utils
   ============================================================ */
function safeJson(s){ try{ return JSON.parse(s); }catch{ return null; } }
function escapeHtml(s){
  return String(s ?? "").replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}
function toast(title, msg, kind="info"){
  const wrap = document.getElementById("toasts");
  const t = document.createElement("div");
  t.className = "toast";
  const icon = kind==="ok" ? "‚úÖ" : kind==="bad" ? "‚ùå" : kind==="warn" ? "‚ö†Ô∏è" : "‚ÑπÔ∏è";
  t.innerHTML = `
    <div style="font-size:18px;line-height:1">${icon}</div>
    <div>
      <b>${escapeHtml(title)}</b>
      <div class="mini muted">${escapeHtml(msg)}</div>
    </div>
  `;
  wrap.appendChild(t);
  setTimeout(()=>{ t.style.opacity="0"; t.style.transform="translateY(6px)"; }, 3200);
  setTimeout(()=>{ t.remove(); }, 3800);
}
function go(hash){ location.hash = hash; }
function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }

function githubBlobToRaw(url){
  try{
    const u = String(url||"").trim();
    if(!u) return u;
    if(u.includes("raw.githubusercontent.com")) return u;
    return u.replace("https://github.com/", "https://raw.githubusercontent.com/")
            .replace("/blob/", "/");
  }catch{ return url; }
}

function setServerBadge(online){
  const dot = document.getElementById("srvDot");
  const line = document.getElementById("srvLine");
  if(online){
    dot.style.background = "var(--ok)";
    dot.style.boxShadow = "0 0 0 6px rgba(34,197,94,.10)";
    line.textContent = "Servidor: Online ‚úÖ";
  }else{
    dot.style.background = "var(--bad)";
    dot.style.boxShadow = "0 0 0 6px rgba(239,68,68,.10)";
    line.textContent = "Servidor: Offline ‚ùå";
  }
}

function apiUrl(path){
  const base = (state.apiBase || "").replace(/\/+$/,"");
  return base + path;
}

/* ============================================================
   Boot: sempre pega server_status.json ao abrir
   ============================================================ */
async function fetchStatusAlways(){
  const rawUrl = githubBlobToRaw(STATUS_GITHUB_URL);
  for(let attempt=1; attempt<=2; attempt++){
    try{
      const res = await fetch(rawUrl, { cache:"no-store" });
      if(!res.ok) throw new Error("Falha baixando server_status.json");
      return await res.json();
    }catch(err){
      if(attempt===2) throw err;
      await sleep(500);
    }
  }
}

async function boot(){
  renderNav();
  try{
    const st = await fetchStatusAlways();
    state.status = st;

    const base = String(st?.url_api_base || "").trim();
    if(!base) throw new Error("server_status.json sem url_api_base");
    state.apiBase = base.replace(/\/+$/,"");
    localStorage.setItem(LS.apiBase, state.apiBase);

    const online = String(st?.status_servidor || "").toLowerCase().includes("online");
    setServerBadge(online);

    // tenta ping s√≥ pra validar (n√£o quebra se der erro)
    await apiCall({ comando:"/ping" }).catch(()=>{});
  }catch(err){
    setServerBadge(false);
    // fallback: se j√° tiver cache, usa pra n√£o ficar travado
    const cached = localStorage.getItem(LS.apiBase) || "";
    if(cached){
      state.apiBase = cached;
      toast("Status", "Falha lendo GitHub. Usando API base em cache.", "warn");
    }else{
      toast("Boot falhou", err?.message || String(err), "bad");
    }
  }finally{
    render();
  }
}

/* ============================================================
   API: SEMPRE JSON + /api/v1/cmd
   ============================================================ */
async function apiCall(payload){
  if(!state.apiBase) throw new Error("API base vazia (status.json n√£o carregou).");

  // sempre manda UA e IP (IP real s√≥ o servidor vai ver; aqui s√≥ "client")
  const finalPayload = {
    ...payload,
    ua: navigator.userAgent,
    ip: "client", // opcional, teu backend aceita
  };

  const headers = { "Content-Type":"application/json" };
  if(state.token) headers["Authorization"] = "Bearer " + state.token;

  const url = apiUrl("/api/v1/cmd");

  const r = await fetch(url, {
    method:"POST",
    headers,
    body: JSON.stringify(finalPayload),
  });

  // tenta ler JSON, mas se vier texto, mostra
  const text = await r.text();
  const j = safeJson(text);

  if(!r.ok){
    const msg = (j && (j.error || j.message)) ? (j.error || j.message) : (text || "HTTP error");
    throw new Error(msg);
  }

  if(!j || typeof j !== "object"){
    throw new Error("Resposta n√£o √© JSON (backend retornou texto).");
  }

  if(j.ok === false){
    throw new Error(j.error || "Falha no comando");
  }

  return j;
}

/* ============================================================
   Auth (conforme Comandos.py)
   ============================================================ */
async function doRegister(username, email, senha){
  // Comandos.py espera: username/email/senha
  const out = await apiCall({ comando:"/register", username, email, senha });
  toast("Registro", out.message || "Conta criada.", "ok");
  go("#/login");
}

async function doLogin(login, senha){
  // Comandos.py espera: login/senha
  const out = await apiCall({ comando:"/login", login, senha });
  const token = out.session_token;
  if(!token) throw new Error("Login OK mas n√£o veio session_token.");
  state.token = token;
  localStorage.setItem(LS.token, token);
  toast("Login", "Sess√£o salva ‚úÖ", "ok");
  go("#/panel");
}

async function doLogout(){
  try{ await apiCall({ comando:"/logout" }); }catch{}
  state.token = "";
  localStorage.removeItem(LS.token);
  toast("Logout", "Sess√£o removida.", "ok");
  go("#/login");
}

/* ============================================================
   Router
   ============================================================ */
window.addEventListener("hashchange", ()=>{
  state.route = location.hash || "#/login";
  render();
});

function renderNav(){
  const nav = document.getElementById("nav");
  nav.innerHTML = "";

  const authed = !!state.token;

  if(!authed){
    nav.appendChild(btn("üîê Login", ()=>go("#/login"), "primary"));
    nav.appendChild(btn("üßæ Registrar", ()=>go("#/register")));
    return;
  }

  nav.appendChild(btn("üéõÔ∏è Painel", ()=>go("#/panel"), "primary"));
  nav.appendChild(btn("üß© Personagem", ()=>go("#/character")));
  nav.appendChild(btn("üö™ Sair", doLogout, "ghost"));
}

function btn(label, onClick, cls=""){
  const b = document.createElement("button");
  b.className = "btn " + cls;
  b.textContent = label;
  b.onclick = onClick;
  return b;
}

function guard(){
  const r = state.route || "#/login";
  if(!state.token && (r.startsWith("#/panel") || r.startsWith("#/character"))){
    go("#/login");
    return false;
  }
  return true;
}

function render(){
  renderNav();
  if(!guard()) return;

  const app = document.getElementById("app");
  const r = state.route || "#/login";

  if(r.startsWith("#/login")) return viewLogin(app);
  if(r.startsWith("#/register")) return viewRegister(app);
  if(r.startsWith("#/panel")) return viewPanel(app);
  if(r.startsWith("#/character")) return viewCharacter(app);

  go("#/login");
}

/* ============================================================
   Views
   ============================================================ */
function viewLogin(app){
  const st = state.status || {};
  app.innerHTML = `
    <div class="grid">
      <div class="card">
        <h2>üîê Login</h2>
        <div class="muted">Entre com seu <b>email</b> ou <b>username</b> (campo <span class="tag">login</span>).</div>
        <div class="hr"></div>

        <div class="field">
          <label>Email ou Username (login)</label>
          <input id="login" placeholder="email@exemplo.com ou seuNick" autocomplete="username" />
        </div>
        <div class="field">
          <label>Senha</label>
          <input id="senha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" />
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="btnLogin">Entrar</button>
          <button class="btn" onclick="location.hash='#/register'">Criar conta</button>
        </div>

        <div class="hr"></div>
        <div class="mini muted">
          ‚úÖ Envia: <span class="tag">{comando:"/login", login, senha}</span> para <span class="tag">/api/v1/cmd</span>.
        </div>
      </div>

      <div class="card">
        <h2>üì° Status</h2>
        <div class="mini muted">Lido do <span class="tag">server_status.json</span> no GitHub a cada abertura.</div>
        <div class="hr"></div>
        <div class="mini"><b>status_servidor:</b> <span class="tag">${escapeHtml(st.status_servidor ?? "‚Äî")}</span></div>
        <div class="mini"><b>version_api:</b> <span class="tag">${escapeHtml(st.version_api ?? "‚Äî")}</span></div>
        <div class="mini"><b>porta:</b> <span class="tag">${escapeHtml(st.porta ?? "‚Äî")}</span></div>
        <div class="hr"></div>
        <div class="mini"><b>API Base (oculta na UI, mas aqui pra debug):</b></div>
        <div class="tag">${escapeHtml(state.apiBase || "‚Äî")}</div>
      </div>
    </div>
  `;

  const login = app.querySelector("#login");
  const senha = app.querySelector("#senha");
  const btnLogin = app.querySelector("#btnLogin");

  btnLogin.onclick = async ()=>{
    const l = (login.value||"").trim();
    const s = (senha.value||"");
    if(!l || !s){ toast("Ops", "Preenche login e senha üòÖ", "warn"); return; }

    btnLogin.disabled = true; btnLogin.textContent = "Entrando‚Ä¶";
    try{ await doLogin(l, s); }
    catch(err){ toast("Login falhou", err?.message || String(err), "bad"); }
    finally{ btnLogin.disabled = false; btnLogin.textContent = "Entrar"; }
  };
}

function viewRegister(app){
  app.innerHTML = `
    <div class="grid">
      <div class="card">
        <h2>üßæ Registrar</h2>
        <div class="muted">Cria conta (Comandos.py: <span class="tag">username/email/senha</span>).</div>
        <div class="hr"></div>

        <div class="field">
          <label>Username</label>
          <input id="username" placeholder="3-32: letras/n√∫meros/espa√ßo/_" autocomplete="nickname" />
          <div class="mini muted">Regra: <span class="tag">^[\\w ]{3,32}$</span> (sem s√≠mbolos).</div>
        </div>

        <div class="field">
          <label>Email</label>
          <input id="email" placeholder="email@exemplo.com" autocomplete="email" />
        </div>

        <div class="field">
          <label>Senha</label>
          <input id="senha" type="password" placeholder="m√≠n. 6 chars" autocomplete="new-password" />
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="btnReg">Criar</button>
          <button class="btn" onclick="location.hash='#/login'">Voltar</button>
        </div>

        <div class="hr"></div>
        <div class="mini muted">
          ‚úÖ Envia: <span class="tag">{comando:"/register", username, email, senha}</span> para <span class="tag">/api/v1/cmd</span>.
        </div>
      </div>

      <div class="card">
        <h2>üß† Token</h2>
        <div class="muted">
          Token fica no <span class="tag">localStorage</span> (ok pra dev).<br/>
          Em produ√ß√£o ‚Äúreal‚Äù: cookie HttpOnly.
        </div>
      </div>
    </div>
  `;

  const username = app.querySelector("#username");
  const email = app.querySelector("#email");
  const senha = app.querySelector("#senha");
  const btnReg = app.querySelector("#btnReg");

  btnReg.onclick = async ()=>{
    const u = (username.value||"").trim();
    const e = (email.value||"").trim();
    const s = (senha.value||"");
    if(!u || !e || !s){ toast("Ops", "Preenche username, email e senha üòÖ", "warn"); return; }

    btnReg.disabled = true; btnReg.textContent = "Criando‚Ä¶";
    try{ await doRegister(u, e, s); }
    catch(err){ toast("Registro falhou", err?.message || String(err), "bad"); }
    finally{ btnReg.disabled = false; btnReg.textContent = "Criar"; }
  };
}

function viewPanel(app){
  app.innerHTML = `
    <div class="grid">
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div>
            <h2>üéõÔ∏è Painel</h2>
            <div class="muted">Testes diretos dos comandos do seu backend.</div>
          </div>
          <span class="pill ok">Autenticado</span>
        </div>

        <div class="hr"></div>

        <div class="field">
          <label>Session Token (salvo)</label>
          <input value="${escapeHtml(state.token)}" readonly />
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="btnWho">üë§ /whoami</button>
          <button class="btn" id="btnPing">üèì /ping</button>
          <button class="btn danger" onclick="doLogout()">üö™ Logout</button>
        </div>

        <div class="hr"></div>
        <div class="field">
          <label>Resposta</label>
          <textarea id="out" readonly></textarea>
        </div>
      </div>

      <div class="card">
        <h2>‚ÑπÔ∏è Envio</h2>
        <div class="mini muted">
          Sempre manda JSON para: <span class="tag">POST /api/v1/cmd</span><br/>
          Header: <span class="tag">Authorization: Bearer {token}</span>
        </div>
        <div class="hr"></div>
        <div class="mini muted"><b>API Base:</b></div>
        <div class="tag">${escapeHtml(state.apiBase || "‚Äî")}</div>
      </div>
    </div>
  `;

  const out = app.querySelector("#out");
  const btnWho = app.querySelector("#btnWho");
  const btnPing = app.querySelector("#btnPing");

  btnWho.onclick = async ()=>{
    btnWho.disabled = true;
    try{
      const j = await apiCall({ comando:"/whoami" });
      out.value = JSON.stringify(j, null, 2);
      toast("whoami", "OK ‚úÖ", "ok");
    }catch(err){
      out.value = String(err?.message || err);
      toast("whoami", err?.message || String(err), "bad");
    }finally{
      btnWho.disabled = false;
    }
  };

  btnPing.onclick = async ()=>{
    btnPing.disabled = true;
    try{
      const j = await apiCall({ comando:"/ping" });
      out.value = JSON.stringify(j, null, 2);
      toast("ping", "OK ‚úÖ", "ok");
    }catch(err){
      out.value = String(err?.message || err);
      toast("ping", err?.message || String(err), "bad");
    }finally{
      btnPing.disabled = false;
    }
  };
}

function viewCharacter(app){
  app.innerHTML = `
    <div class="grid">
      <div class="card">
        <h2>üß© Criar Personagem</h2>
        <div class="muted">Comando: <span class="tag">/createcharacter</span> com <span class="tag">nome</span>.</div>
        <div class="hr"></div>

        <div class="field">
          <label>Nome do personagem</label>
          <input id="nome" placeholder="Ex: NihilGuh" />
        </div>

        <div class="row" style="margin-top:10px">
          <button class="btn primary" id="btnCreate">Criar</button>
          <button class="btn" onclick="location.hash='#/panel'">Voltar</button>
        </div>

        <div class="hr"></div>
        <div class="field">
          <label>Resposta</label>
          <textarea id="out" readonly></textarea>
        </div>
      </div>

      <div class="card">
        <h2>‚úÖ JSON enviado</h2>
        <div class="mini muted">
          <span class="tag">{comando:"/createcharacter", nome:"..."}</span><br/>
          Sempre via <span class="tag">POST /api/v1/cmd</span>.
        </div>
      </div>
    </div>
  `;

  const nome = app.querySelector("#nome");
  const out = app.querySelector("#out");
  const btnCreate = app.querySelector("#btnCreate");

  btnCreate.onclick = async ()=>{
    const n = (nome.value||"").trim();
    if(!n){ toast("Ops", "Digite um nome üòÖ", "warn"); return; }

    btnCreate.disabled = true; btnCreate.textContent = "Criando‚Ä¶";
    try{
      const j = await apiCall({ comando:"/createcharacter", nome: n });
      out.value = JSON.stringify(j, null, 2);
      toast("Personagem", "Criado ‚úÖ", "ok");
    }catch(err){
      out.value = String(err?.message || err);
      toast("Falhou", err?.message || String(err), "bad");
    }finally{
      btnCreate.disabled = false; btnCreate.textContent = "Criar";
    }
  };
}

/* start */
boot();
</script>
</body>
</html>
